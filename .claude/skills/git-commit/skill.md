# Git 自动提交技能

当用户调用此技能时，执行以下自动化 Git 提交流程：

## 执行步骤

### 1. 分析变更内容
- 运行 `git status` 查看未跟踪和修改的文件
- 运行 `git diff` 查看具体变更内容
- 运行 `git log --oneline -5` 查看最近的提交历史，了解项目的提交风格

### 2. 生成提交信息
基于以下规则生成简洁的中文提交信息：
- **格式**: `<类型>: <简短描述>`
- **类型**: 新增(add)、修复(fix)、更新(update)、删除(remove)、重构(refactor)、文档(docs)、测试(test)、样式(style)
- **描述**: 清晰说明变更的目的和内容，避免废话
- **约定式提交风格**: 参考项目现有的提交信息格式

### 3. 执行提交
- 使用 `git add` 添加相关文件到暂存区
- 使用生成的提交信息创建提交，必须包含 `Co-Authored-By: Claude <noreply@anthropic.com>`
- 运行 `git status` 验证提交成功
- 询问用户是否需要推送到远程仓库

### 4. 推送到远程（可选）
如果用户确认推送：
- 检查当前分支是否跟踪远程分支
- 执行 `git push` 推送变更
- 处理可能的推送错误（如权限问题、冲突等）

### 5. 生成提交文档
将本次提交的详细信息输出到 `skills/1.skils.md` 文档中，包含：
- **提交信息**: 完整的提交标题
- **提交时间**: 当前时间戳
- **变更文件**: 列出所有提交的文件
- **变更详情**: 主要变更内容的简要说明
- **提交 SHA**: 提交的哈希值

文档格式示例：
```markdown
# Git 提交记录

## 提交 #{序号}

**提交信息**: {提交标题}
**提交时间**: {YYYY-MM-DD HH:mm:ss}
**提交 SHA**: {commit hash}

### 变更文件
- {文件路径1}
- {文件路径2}

### 变更内容
{变更内容的简要描述}

---
```

## 注意事项

- **安全原则**:
  - 永不修改 git config
  - 不运行破坏性命令（如 --force）
  - 不跳过 hooks（除非用户明确要求）
  - 主分支不使用 force push

- **提交失败处理**:
  - 如果 pre-commit hook 失败，修复问题后创建新提交（不要 amend）
  - 如果已推送到远程，绝不 amend（除非用户明确要求）

- **交互限制**:
  - 不使用需要交互输入的命令（如 -i 标志）
  - 避免使用 git add -uall（大项目可能有内存问题）

- **用户确认**:
  - 推送前必须获得用户确认
  - 提交前显示将要提交的文件列表
  - 允许用户取消操作

## 使用示例

用户只需输入：
```
使用 git-commit 技能提交当前变更
```

技能将自动处理整个提交流程。
